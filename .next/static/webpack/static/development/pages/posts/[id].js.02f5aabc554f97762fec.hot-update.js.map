{"version":3,"file":"static/webpack/static\\development\\pages\\posts\\[id].js.02f5aabc554f97762fec.hot-update.js","sources":["webpack:///./pages/posts/.tsx"],"sourcesContent":["import { useState, FC } from 'react';\nimport Layout from '../components/MyLayout';\nimport axios from 'axios';\nimport styled from 'styled-components';\nimport { NextPage, NextPageContext } from 'next';\n\nconst Section = styled.section`\n  position: relative;\n  font-family: \"Lucida Sans Unicode\", \"Lucida Grande\", sans-serif;\n  width: 60%;\n  padding: 20px;\n  margin-top: 20px;\n  border-radius: 10px;\n  box-shadow: 0 0 17px -1px rgba(0,0,0,0.81);\n\n  & .post__text {\n    margin-bottom: 40px;\n  }\n\n  & .post__text:after {\n    content: \"\";\n    display: block;\n    margin: 40px auto;\n    width: 95%;\n    border-bottom: 1px solid black;\n  }\n`;\n\nconst Comment = styled.div`\n  position: relative;\n  width: 950px;\n  margin: 0 auto 15px;\n  padding: 15px;\n  background-color: #f2f3f5;\n  border-radius: 18px;\n\n  & .destroy-comment {\n    display: none;\n    position: absolute;\n    margin: 0;\n    padding: 0;\n    border: 0;  \n    background: none;\n    top: 5px;\n    right: 10px;\n    width: 30px;\n    font-size: 40px;\n    font-family: arial;\n    color: #cc9a9a;\n    outline: none;\n    transition: color 0.2s ease-out;\n    cursor: pointer;\n\n    &:after {\n      content: \"Ã—\";\n    }\n  }\n\n  & .destroy-comment:hover {\n    color: #af5b5e;\n  }\n\n  &:hover .destroy-comment {\n    display: block;\n  }\n`;\n\nconst Form = styled.form`\n  width: 100%;\n\n  & .form__button {\n    display: block;\n    margin: 0 auto;\n  }\n`;\n\nconst Textarea = styled.textarea`\n  display: block;\n  margin: 10px auto;\n  width: 380px;\n  height: 80px;\n  border-radius: 5px;\n`;\n\nconst loadData = async (id: any) => {\n  const response = await axios.get(`https://simple-blog-api.crew.red/posts/${id}?_embed=comments`);\n  const data = response.data;\n\n  return data;\n};\n\ninterface Props {\n  show: Post\n}\n\n// interface Context extends NextPageContext {\n//   query: \n// }\n\nconst Post: NextPage<Props> = props => {\n  const [value, setValue] = useState('');\n  const [post ,setPost] = useState(props.show);\n\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setValue(event.target.value);\n  }\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n\n    if(!value) {\n      return;\n    }\n\n    await axios.post('https://simple-blog-api.crew.red/comments', {postId: post.id, body: value });\n    \n    const show = await loadData(post.id);\n    setValue('');  \n    setPost(show);\n  }\n\n  const deleteComment = async (event) => {\n    const { id } = event.target.dataset;\n    await axios.delete(`https://simple-blog-api.crew.red/comments/${id}`);\n\n    const show = await loadData(post.id);\n    setPost(show);\n  }\n  \n  return (\n    <Layout>\n      <Section>\n        <h2 className=\"post__heading\">{post.title}</h2>\n        <p className=\"post__text\">{post.body}</p>\n        <div>\n          {post.comments.map(comment => (\n            <Comment key={comment.id}>\n              <button\n                type=\"button\"\n                className=\"destroy-comment\"\n                aria-label=\"Delete\"\n                data-id={comment.id}\n                onClick={deleteComment}\n              />\n              <p className=\"comment__text\">{comment.body}</p>\n            </Comment>\n          ))}\n        </div>\n        <Form onSubmit={handleSubmit}>\n          <Textarea \n            type=\"text\" \n            placeholder=\"input comment\"\n            value={value}\n            onChange={handleChange} \n          />\n          <button type=\"submit\" className=\"form__button\">Add comment</button>\n        </Form>\n      </Section>\n    </Layout>\n  )\n};\n\nPost.getInitialProps = async function(context) {\n  console.log(query);\n  const { id } = context.query;\n  const show = await loadData(id);\n\n  return { show };\n};\n\nexport default Post;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAGA;AAAA;AAAA;AAAA;AAsBA;AAAA;AAAA;AAAA;AAuCA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AACA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AACA;AAFA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAUA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AAAA;AAOA;AAAA;AAAA;AACA;AARA;AAAA;AAAA;AACA;AADA;AASA;AACA;AACA;AACA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAaA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAIA;AACA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAOA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AATA;AAaA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AACA;AADA;AAGA;AAHA;AAKA;AAAA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAOA;;;;A","sourceRoot":""}